diff --git a/paper/content.tex b/paper/content.tex
index ff6dd9b..faf57c9 100644
--- a/paper/content.tex
+++ b/paper/content.tex
@@ -11,9 +11,9 @@ the result of the sum of moments of a large assembly of ferromagnetic grains
 approximately \qty{10}{\cm\cubed} would contain hundreds of thousands
 to millions of magnetic particles with sizes varying from magnetically stable
 single-domain (SD) and vortex state grains (also called pseudo-single domain,
-PSD) with sizes below \qty{1}{\um}, to large ($\gg \qty{1}{\um}$) grains with
-multi-domain (MD) magnetic structures, which are less stable magnetic recorders
-\citep{Berndt2016}. These large MD grains usually conceal the signal of the SD
+PSD) with sizes below \qty{1}{\um} \citep{Berndt2016}, to large ($\gg \qty{1}{\um}$) grains with
+multi-domain (MD) magnetic structures, which are less stable magnetic recorders \citep{Dunlop1997}.
+These large MD grains usually conceal the signal of the SD
 and PSD grains, and techniques of step-wise thermal and magnetic treatments are
 needed to unveil this more stable and reliable magnetic record
 \citep{Tauxe2018}. Recently, magnetic microscopy techniques opened the
@@ -227,7 +227,7 @@ in which $(x_c, y_c, z_c)$ are the coordinates of the magnetic field source (Fig
 The inversion is performed by rearranging Equation~\ref{eq_euler_homogeneity} into a pseudo-parametric model with parameters $x_c$, $y_c$, $z_c$, and $b$
 
 \begin{equation}
-x_c \partial_x f + y_c \partial_x f + z_c \partial_x f + \eta b
+x_c \partial_x f + y_c \partial_y f + z_c \partial_z f + \eta b
 =
 x \partial_x f + y \partial_y f + z \partial_z f + \eta f
 \ .
@@ -414,7 +414,7 @@ The estimated dipole moment vector $\hat{\mathbf{m}}$ can be converted into decl
 \label{eq_vector_to_incdec}
 \begin{aligned}
 I &= \tan^{-1}\dfrac{m_z}{\sqrt{m_x^2 + m_y^2}} \ , \\
-D &= \tan^{-1}\dfrac{m_x}{m_y} \ , \\
+D &= \tan^{-1}\dfrac{m_y}{m_x} \ , \\
 m &= \sqrt{m_x^2 + m_y^2 + m_z^2} \ .
 \end{aligned}
 \end{equation}
@@ -604,12 +604,12 @@ These directions were generated randomly, following a normal distribution center
 The dipole moment amplitudes were sampled by a normal distribution with mean $\qty{e-14}{\ampere\m\squared}$ and standard deviation $\qty{5e-14}{\ampere\m\squared}$.
 We also randomly generated spatial positions around a central position of $x_c=\qty{25}{\um}$, $y_c=\qty{25}{\um}$, and $z_c=\qty{-1}{\um}$ with standard deviation of \qty{0.65}{\um}.
 The bulk magnetization of the non-dipolar particle is the vector sum of the dipole moments of each dipole.
-The centroid of the particle is defined by the average of the $x_c$, $y_c$, and $z_c$ positions of each dipole.
+The centroid of the spherical volume is defined by the average of the $x_c$, $y_c$, and $z_c$ positions of each dipole.
 The synthetic vertical magnetic field $b_z$ of the non-dipolar source was calculated on regular grids with \qty{0.5}{\um} spacing.
 Each grid was located at a different sensor-sample distance $z$, varying between \qty{1}{\um} and \qty{10}{\um} in \qty{0.5}{\um} increments.
 The synthetic data were corrupted by pseudo-random Gaussian noise of mean \qty{0}{\nano\tesla} and a standard deviation of \qty{20}{\nano\tesla}.
 For each data grid generated, we performed Euler deconvolution to estimate the source position and subsequently inverted the data for the dipole moment.
-At each step, we recorded the inversion $R^2$ value and the differences between the estimated position and dipole moment and the true centroid and bulk magnetization of the particle.
+At each step, we recorded the inversion $R^2$ value and the differences between the estimated position and dipole moment and the true centroid and bulk magnetization of the spherical particle.
 
 Figure~\ref{non-dipolarity-synthetic-data} shows the synthetic $b_z$ of an example non-dipolar particle at variable source-sample distances.
 When the particle is close to the sensor (\qtyrange{1}{3}{\um}), the observed field is strongly non-dipolar (Figure~\ref{non-dipolarity-synthetic-data}a-b) and the dipole moment inversion produces low $R^2$ values.
@@ -624,19 +624,20 @@ At distances above \qty{5}{\um}, there is practically only the contribution of t
   \label{non-dipolarity-synthetic-data}
 \end{figure}
 
-We replicated the particle generation procedure 100 times with variations in the randomness of magnetization and point particle positions. Subsequently, the Cartesian position of the spherical particle was estimated using ED, and the magnetization parameters were determined by inverting the magnetic field data. The effectiveness of position recovery was measured by comparing the particle's centroid with the solution of the Euler equation for $x_c$, $y_c$, and $z_c$ (Figure~\ref{non-dipolarity-synthetic-data-positioning}a, b, and c, respectively). As shown in Figure~\ref{non-dipolarity-synthetic-data-positioning}, ED estimates the positions of particles with more complex magnetization well, especially for sensor-source distances greater than 5 µm, where the median of the distributions is centered at zero. However, when the sensor-source distance is small enough to emphasize the contribution from higher-order components, a lower degree of dipolarity is observed as expressed by lower values of $R^2$ (Figure~\ref{non-dipolarity-synthetic-data-inversion}a). Consequently, in these cases, there are higher errors in the estimation of the direction of magnetization (Figure~\ref{non-dipolarity-synthetic-data-inversion}b) and in the magnetic moment's intensity (Figure~\ref{non-dipolarity-synthetic-data-inversion}c), which were expected since the inversion considers only the dipolar component. However, dipolarity significantly increases as the sensor to sample distance increases, while errors in direction and magnetic moment decrease significantly (Figure~\ref{non-dipolarity-synthetic-data-inversion}).
+We replicated the particle generation procedure 100 times with variations in the randomness of magnetization and point particle positions. Subsequently, the Cartesian position of the spherical particle was estimated using ED, and the magnetization parameters were determined by inverting the magnetic field data. The effectiveness of position recovery was measured by comparing the centroid of the spherical volume with the solution of the Euler equation for $x_c$, $y_c$, and $z_c$ (Figure~\ref{non-dipolarity-synthetic-data-positioning}a, b, and c, respectively). As shown in Figure~\ref{non-dipolarity-synthetic-data-positioning}, ED estimates the positions of particles with more complex magnetization well, especially for sensor-source distances greater than 5 µm, where the median of the distributions is centered at zero. However, when the sensor-source distance is small enough to emphasize the contribution from higher-order components, a lower degree of dipolarity is observed as expressed by lower values of $R^2$ (Figure~\ref{non-dipolarity-synthetic-data-inversion}a). Consequently, in these cases, there are higher errors in the estimation of the direction of magnetization (Figure~\ref{non-dipolarity-synthetic-data-inversion}b) and in the magnetic moment's intensity (Figure~\ref{non-dipolarity-synthetic-data-inversion}c), which were expected since the inversion considers only the dipolar component. However, dipolarity significantly increases as the sensor to sample distance increases, while errors in direction and magnetic moment decrease significantly (Figure~\ref{non-dipolarity-synthetic-data-inversion}).
 
 \begin{figure}[tb!]
   \centering
   \includegraphics[width=1\linewidth]{figures/non-dipolarity-synthetic-positioning.png}
-  \caption{The simulation was randomly replicated (N=100) to test the effectiveness of the Euler deconvolution in estimating the position of the modeled particles. The difference between the true position (centroid) and the estimated position was calculated for each replicate and plotted as a boxplot. The boxplot shows the distribution of differences in the (a) $x_c$, (b) $y_c$, and (c) $z_c$.}
+  \caption{The simulation was randomly replicated (N=100) to test the effectiveness of the Euler deconvolution in estimating the position of the modeled particles. The difference between the true position (centroid) and the estimated position was calculated for each replicate and plotted as a boxplot. The boxplot shows the distribution of differences in the (a) $x_c$, (b) $y_c$, and (c) $z_c$. The black dots represent outliers in the distributions.}
   \label{non-dipolarity-synthetic-data-positioning}
 \end{figure}
 
 \begin{figure}[tb!]
   \centering
   \includegraphics[width=1\linewidth]{figures/non-dipolarity-synthetic-inversion.png}
-  \caption{The simulation was randomly replicated (N=100) to assess the accuracy of the algorithm in recovering the magnetic direction and moment of the modeled particles. The goodness of fit was measured by the R-squared value (a), while the angular error (b) and intensity error (c) between the real and modeled magnetic vector were plotted in degrees and percentages ($|100 \left( m_{true} - m_{estimated}\right) ~/~ m_{true}|$), respectively.}
+  \caption{The simulation was randomly replicated (N=100) to assess the accuracy of the algorithm in recovering the magnetic direction and moment of the modeled particles. The goodness of fit was measured by the R-squared value (a), while the angular error (b) and intensity error (c) between the real and modeled magnetic vector were plotted in degrees and percentages ($|100 \left( m_{true} - m_{estimated}\right) ~/~ m_{true}|$), respectively. The black dots represent outliers in the distributions.
+}
   \label{non-dipolarity-synthetic-data-inversion}
 \end{figure}
 
@@ -649,11 +650,11 @@ The synthetic $b_z$ data were generated on a regular grid with $\qty{2}{\um}$ sp
 We contaminated the data with high-frequency normally-distributed pseudo-random noise with zero mean and $\qty{50}{\nano\tesla}$ standard deviation, as well as with low-frequency noise in the form of additional deep sources beyond the modeling domain.
 
 For greater fidelity to real samples, the magnetic sources are modeled as dipoles with different depths and magnetic moment intensities.
-The depths vary randomly between 1 and $\qty{20}{\um}$, while the dipole moment intensities range randomly from $10^{-12}$ to $\qty{e-14}{\ampere\m\squared}$.
+The depths vary randomly between 1 and $\qty{20}{\um}$, while the dipole moment intensities range randomly from $10^{-11}$ to $\qty{e-14}{\ampere\m\squared}$.
 The NRM found in real ferromagnetic particles varies individually but averages out to the inducing field direction.
 To simulate this behavior in our synthetic data, we sample the source dipole moment directions from two pseudo-random Gaussian distributions.
 The first group of sources ($M = 70$) are sampled from a distribution  with mean of $D = \ang{0}$ and $I = \ang{0}$ and standard deviation of $\ang{10}$.
-The second group of sources ($M = 30$) are sampled from a distribution with mean of $D = \ang{180}$ and $I = \ang{0}$, also with standard deviation of $\ang{10}$. We also manually added 3 sources with higher dipole moments ($5x10^{-11}$) to further simulate the complexity observed in real data measurements. The noise-corrupted synthetic $b_z$ data are shown in Figure~\ref{complex-synthetic-data}a.
+The second group of sources ($M = 30$) are sampled from a distribution with mean of $D = \ang{180}$ and $I = \ang{0}$, also with standard deviation of $\ang{10}$. We also manually added 3 sources with higher dipole moments ($5$x$10^{-11}$) to further simulate the complexity observed in real data measurements. The noise-corrupted synthetic $b_z$ data are shown in Figure~\ref{complex-synthetic-data}a.
 
 \begin{figure}[tb!]
   \centering
@@ -679,13 +680,13 @@ The second group of sources ($M = 30$) are sampled from a distribution with mean
 
 We then followed the same processing steps as for the simple synthetic: upward continuation (Figure~\ref{complex-synthetic-data}b),
 TGA calculation (Figure~\ref{complex-synthetic-data}c), contrast stretching (Figure~\ref{complex-synthetic-data}d), blob detection (Figure~\ref{complex-synthetic-data}e), and Euler Deconvolution (Figure~\ref{complex-synthetic-data}e).
-A total of 99 sources out of the original 103 were successfully detected by our workflow.
+A total of 99 sources out of the original 103 were successfully detected in approximately 8 seconds by our algorithm. It further determined the 3D positions and dipole moments of these sources in just 1.5 seconds, all while running on an Intel(R) Core(TM) i7-2670QM CPU 2.20GHz with 16 GB of DDR3L 1333 MHz RAM. Four sources remained unidentified (black stars, Figure~\ref{complex-synthetic-data}f) due to specific challenges, that arose from two primary factors. First, three of these sources either were overlapped by or were in close proximity to other neighboring sources, making it inherently difficult to distinguish and isolate them. Second, the identification of one of these sources was impeded by its considerable depth, which led to substantial signal attenuation, further exacerbating the difficulties associated with source recognition.
 
 \begin{figure}[tb!]
 \centering
 \includegraphics[width=0.75\linewidth]{figures/complex-synthetic-comparison.png}
 \caption{
-The validation of the result obtained with the inversion was calculated for each individual particle based on the error between the real parameters modeled and their respective recovered values, being (a) the direction and (b) intensity of the magnetic moment, in addition to the $R^2$ score (c) obtained by comparing the forward model and the actual data. The depth and radius of the magnetic sources are also important factors that influence the final result, therefore, these data are given in the form of cross plots, with the vertical bar represented by the depth (1 - 20 $\mu m$) and the horizontal bar by the dipole moment amplitude ($10^{-12}$ to $10^{-14}$ $Am^2$).
+The validation of the result obtained with the inversion was calculated for each individual particle based on the error between the real parameters modeled and their respective recovered values, being (a) the direction and (b) intensity of the magnetic moment, in addition to the $R^2$ score (c) obtained by comparing the forward model and the actual data. The depth and radius of the magnetic sources are also important factors that influence the final result, therefore, these data are given in the form of cross plots, with the vertical bar represented by the depth (1 - 20 $\mu m$) and the horizontal bar by the dipole moment amplitude ($10^{-11}$ to $10^{-14}$ $Am^2$).
 }
 \label{complex-synthetic-comparison}
 \end{figure}
@@ -703,8 +704,8 @@ Figure~\ref{complex-synthetic-comparison}d shows the SNR (Equation~\ref{eq_snr})
 High SNR values correspond to small inversion residuals which indicate that a dipolar model was able to explain the observed data.
 Consequently, the variation of SNR values is similar to that of the $R^2$ coefficient.
 Figure~\ref{complex-synthetic-comparison} shows that large errors in the estimated dipole moment direction are associated with low values of $R^2$ and SNR.
-Conversely, the correlation between errors in dipole moment magnititude and $R^2$ and SNR is less pronounced, with some poor magnitude estimates being associated with $R^2$ and SNR indicating a good fit of the dipolar model.
-It is also noticeable that the majority of cases where the dipole moment direction error is large are associated with deep and low-amplitude sources that are close to shallower or higher-amplitude sources.
+Conversely, the correlation between errors in dipole moment magnitude and $R^2$ and SNR is less pronounced, with some poor magnitude estimates being associated with $R^2$ and SNR indicating a reasonable fit by dipolar model.
+It is also noticeable that the majority of cases where the direction misfit is given by deep and low-amplitude sources that are close to shallower or higher-amplitude sources.
 These results indicated that $R^2$ and SNR can be used as selection criteria to discard sources with likely high errors in the estimated dipole moment.
 
 \begin{figure}[tb!]
@@ -718,6 +719,20 @@ a) Simulation of a thin section of rock with 103 particles uniformly magnetized
 
 Figure~\ref{complex-synthetic-stereograms} shows stereograms with the directions generated by the modeled (Figure~\ref{complex-synthetic-stereograms}a) and the estimated vectors (Figure~\ref{complex-synthetic-stereograms}b) for each source. The distribution of the estimated directions is coincident with the true directions aside from a few sources, the same ones with the higher values of direction misfit (Figure~\ref{complex-synthetic-comparison}a) which is probably associated with the mutual interference of sources close to each other or within the same window. When filtered to include only data with R\textsuperscript{2} \textgreater 0.85 and SNR \textgreater 5 the obtained direction distribution is closer to the true distribution (Figure~\ref{complex-synthetic-stereograms}c).
 
+\subsection{Applicability to different grain concentration scenarios}
+
+In order to assess the algorithm's ability to work with samples featuring higher concentrations of particles, we conducted multiple scenario tests (with 15 repetitions each) by increasing the concentrations of magnetic grains. Figure~\ref{grain-concentration}a depicts the percentage of particle detection by the algorithm, with the median of the distribution represented by the red line. The same figure also presents the percentage of windows whose inversion results meet the filtering criteria of $R^2 \geq 0.85$ and $SNR \geq 5$, with the median represented by the blue line. As the number of particles increases, there is a consistent decrease in the percentage of source detection, particularly due to the spatial constraints of the algorithm, which require magnetic sources to be sparsely distributed for optimal detection. However, as shown in Figure~\ref{grain-concentration}b, by calculating the angular misfit between the vector sum direction of the model and the vector sum direction of the detected windows, it is observed that for the unfiltered windows (red line), the angular misfits tend to increase with the concentration of magnetic grains. Nonetheless, when applying the filtering criteria, this misfit tends to approach zero.
+
+This observation highlights the algorithm's ability to effectively filter out spurious detection and improve the reliability of source detection, particularly in scenarios with higher particle concentrations. These findings underscore the algorithm's robustness in handling varying sample conditions and its capacity to adapt to different levels of particle density.
+
+\begin{figure}[tb!]
+  \centering
+  \includegraphics[width=1\linewidth]{paper/figures/grain-concentration.png}
+  \caption{ 
+  Different grains simulations randomly replicated (N=15) to assess the effectiveness of the algorithm to detect the magnetic sources. a) The efficacy of the detection was measured by percentage of sources identified ($100 \left( N_{detected~sources} ~/~ N_{true~sources} \right)$) and showed as box-plots for both unfiltered detection (median represented as the red line) and filtered detection ($R^2 \geq 0.85$ and $SNR \geq 5$, blue line). b) The same representation is displayed for the angular misfit between the true vector sum and both results for the filtered and unfiltered sum of vectors detected. The blue/red dots represent outliers in the distributions.
+  }
+  \label{grain-concentration}
+\end{figure}
 
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 \section{Application to real data}
@@ -742,9 +757,9 @@ Diamond Microscope (QDM) at Harvard University over a sample section of
 approximately $\qty{1410}{\um} \times \qty{2256}{\um}$ (Figure~\ref{real-data}a) with a grid
 spacing of \qty{2.35}{\um} and a sensor-sample distance of approximately \qty{5}{\um}, totaling
 576,000 data points. The QDM is housed in a shielded room, in
-order to avoid the influence of the Earth's magnetic field while the data were taken in projected magnetic microscopy (PMM) mode and converted to the vertical component of magnetic field ($b_z$) using a spectral approach \citep{Lima2009, Fu2020,
+order to avoid the influence of the Earth's magnetic field while the data were taken in projected magnetic microscopy mode and converted to the vertical component of magnetic field ($b_z$) using a spectral approach \citep{Lima2009, Fu2020,
 Glenn2017}. We applied a bias field of \qty{0.9}{\milli\tesla} during the measurement, which was periodically reversed to result in an effective background field of $< \qty{1}{\micro\tesla}$.  After applying the magnetic anomaly detection algorithm (Figure~\ref{real-data}b-e), it was
-possible to determine the windows for 75 potential sources, as shown in Figure~\ref{real-data}e.
+possible to determine the windows for 100 potential sources (within 3 seconds), in which 75 were filtered with coherent ED position ($z_c \leq 0$), as shown in Figure~\ref{real-data}e.
 
 \begin{figure}[tb!]
 \centering
@@ -765,7 +780,7 @@ possible to determine the windows for 75 potential sources, as shown in Figure~\
 \label{real-data}
 \end{figure}
 
-After applying the ED algorithm, we performed the inversion of the magnetic moment for each of the 75 windows selected previously. In order to reduce considerably the computation time, the inversions were done within each data window, instead of solving all sources parameters at the same time. We obtained the magnetic moment and the direction for all 75 magnetic grains (Figure~\ref{real-data-stereograms}a). Then, we calculated the residuals of the inversions in each window and subsequently the coefficient of determination $R^2$ and signal-to-noise ratio (SNR), which were parameters used as filters for the best directions obtained. We considered a good fit to be achieved when $R^2$ was greater or equal to 0.85 and SNR was greater than 5. An $R^2$ value of 0.85 indicates that \qty{85}{\percent} of the measured magnetic data is explained by the predicted dipole model, which is equivalent to the dipolarity test approach \citep{Fu2020}. On the other hand, an SNR of 5 means that the dipolar signal is 5 times greater than the residual noise. By using these criteria, we ensured that the fit was sufficiently accurate and the dipole model provided a reliable approximation of the original magnetic data. About 46 identified sources passed these criteria. This filtering technique removed the poorly fit predicted models as well as the ones too corrupted with noise, showing more clearly the expected directional clusters of hematite and magnetite crystals (Figure~\ref{real-data-stereograms}b). Notably, it is confirmed that the sample has both magnetic minerals, but by the expected directions we can also stipulate that the magnetite grains outnumber the hematite ones.
+In order to reduce considerably the computation time, the ED and magnetic moment inversions were done within each data window, instead of solving all sources parameters at the same time. We obtained (within 2.5 seconds) the position and dipole moment for all 75 magnetic grains (Figure~\ref{real-data-stereograms}a). Then, we calculated the residuals of the inversions in each window and subsequently the coefficient of determination $R^2$ and signal-to-noise ratio (SNR), which were parameters used as filters for the best directions obtained. We considered a good fit to be achieved when $R^2$ was greater or equal to 0.85 and SNR was greater than 5. An $R^2$ value of 0.85 indicates that \qty{85}{\percent} of the measured magnetic data is explained by the predicted dipole model, which is equivalent to the dipolarity test approach \citep{Fu2020}. On the other hand, an SNR of 5 means that the dipolar signal is 5 times greater than the residual noise. By using these criteria, we ensured that the fit was sufficiently accurate and the dipole model provided a reliable approximation of the original magnetic data. About 46 identified sources passed these criteria. This filtering technique removed the poorly fit predicted models as well as the ones too corrupted with noise, showing more clearly the expected directional clusters of hematite and magnetite crystals (Figure~\ref{real-data-stereograms}b). Notably, it is confirmed that the sample has both magnetic minerals, but by the expected directions we can also stipulate that the magnetite grains outnumber the hematite ones.
 
 \begin{figure}[tb!]
 \centering
@@ -780,32 +795,20 @@ a) All estimated directions without filtering ($M=75$). b) Estimated directions
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 \section{Discussion}
 
-\subsection{Prior information and uniqueness of solutions}
-
-Working with potential field data might be very tricky once there is too much ambiguity involved during data modeling, thus to obtain unique and reliable results from data inversion it is necessary to provide as much prior information as possible.
-One way to circumvent the ambiguity is to incorporate prior information about the subsurface structure, such as the positioning of a known source of magnetization.
-Magnetic field measurements are more sensitive to changes in magnetization near the source that is causing the anomaly.
-When the position of the source is known, it constrains the model to be as consistent as possible with the observed data, hence increasing the likelihood of obtaining unique solutions.
-\citet{Oliveira2015Estimation} proved that the magnetization directions (Dec and Inc) recovered by the least squares estimator are sensitive to great variations in the horizontal coordinates of the center of the magnetic sources, but are practically insensitive to variations in depth.
-Thus, they consider the ED method as an adequate technique to estimate the central positions that will be used as prior information for inversion.
-This occurs mainly because, when well performed, the recovery of the source's horizontal coordinates is considerably accurate, while the vertical coordinate can undergo greater variation even though it still provides satisfactory results \citep{Silva20033D, Melo2013}.
-This remark is also better observed in our simple synthetic sample where the estimated horizontal positions slightly deviate from the true values, which implies small misfit values in the recovered magnetic directions.
-Although the estimated magnetic moment for the said sample is satisfactory, this magnetic parameter is more affected by the variations in the depth of the source, which is probably caused by ambiguities.
-In summary, in order to estimate all magnetic parameters as precisely as possible the ED must be executed within a data window containing the lowest amount possible of noise since that high-frequency noise sensibility is one of the ED's main limitations.
-
-\subsection{A critical examination of the source detection}
-
 Since the pioneering work of \cite{Egli2000}, many methodologies were proposed for solving the inverse problem o micromagnetic data, and for the purpose of comparison we separate them into two categories based on the main estimated parameter by the inversion procedure.
 In the first type of approach, the main goal is usually to estimate average magnetization by inverting the whole sample superficial magnetization data commonly by means of unidirectional problem, uniform directions with non-negative variable dipole moments \citep[e.g.,][]{Weiss2007}, including performance enhancement in the spatial domain \citep[e.g.,][]{Myre2019} or frequency domain  \citep[e.g.,][]{Lima2013}.
 This methodology can be used to remarkably estimate the average magnetic direction and the total moment direction with the assumption that the particles were all magnetized in the direction of the same induced field \citep[sIRM and/or NRM in basalts,][]{Weiss2007}.
 However, this assumption is not always true when dealing with complex samples (i.e., more than one stable direction), which leads to the same drawbacks as the classic paleomagnetic measurements using bulk samples.
-The second type of approach has the goal of finding the individual source magnetic properties, which can be done by either inverting the dipole moment of a single source within a cropped section of an upward continued anomaly map \citep[e.g.,][]{Lima2016, Fu2020} or by the insertion of additional information of the sources’ shape, such as micro-computed tomography (microCT) \citep[e.g.,][]{Fabian2019, DeGroot2018, DeGroot2021}.
+The second type of approach has the goal of finding the individual source magnetic properties, which can be done by either inverting the dipole moment of a single source within a cropped section of an upward continued anomaly map \citep[e.g.,][]{Lima2016, Fu2020} or by the insertion of additional information of the sources’ shape, such as micro-computed tomography (microCT) \citep[e.g.,][]{Fabian2019, DeGroot2018, DeGroot2021, Koster2023}.
 The latter further allows unique estimation of magnetic moment configuration of even higher orders components through spherical harmonics expansion constrained by micromagnetic models \citep[e.g.,][]{CortesOrtuno2021, CortesOrtuno2022}.
 Such outstanding techniques come with some troubles of having to mechanically select the data for inversion or dealing with the weaknesses of the additional method used.
-The MicroCT, for example, is a popular non-destructive technique for high-resolution imaging of the material internal structures, and yet, it is accompanied by some limitations when it comes to paleomagnetic studies: firstly, the technique has a spatial resolution on the order of micrometers, which is not sufficient to directly image the fined grained single-domain magnetite \citep{DeGroot2018}.
-The microCT also struggles to discern ferromagnetic (\textit{l.s.}) from non-magnetic/antiferromagnetic minerals, as pointed out by \cite{DeGroot2021}, since they usually have similar densities and therefore similar X-ray attenuation \citep{Cnudde2013}.
+The MicroCT, for example, is a popular non-destructive technique for high-resolution imaging of the material internal structures, and yet, it is accompanied by some limitations when it comes to paleomagnetic studies: firstly, the technique has a spatial resolution on the order of $\mu m$, which is not sufficient to directly image the fined grained single-domain magnetite \citep{DeGroot2018}.
+The microCT also struggles to discern ferromagnetic (\textit{l.s.}) from non-magnetic/antiferromagnetic minerals (although assigning to them negligible magnetization), as pointed out by \cite{DeGroot2021}, since they usually have similar densities and therefore similar X-ray attenuation \citep{Cnudde2013}.
 In any case, the major limitation of microCT lies in the trade-off between the resolution and the sample size, requiring small sample volumes to achieve higher resolutions causing the technique to be too time-consuming.
 
+
+\subsection{TGA-guided windows: magnetic source detection using LoG Kernel} %A critical examination of the source detection
+
 Our proposed methodology has the goal of finding each individual source’s dipole moment components without the trouble of mechanically selecting cropped data or needing any type of additional information.
 However, to better examine its advantages and disadvantages we first need to point out the strengths and weaknesses of the technique used in the detection of sources, the Laplacian of Gaussian (LoG) kernel \citep{Marr1980}.
 The LoG is a computer imaging technique that is able to identify regions where the intensity changes abruptly by convolving the image with the LoG filter, and is the result of the combination of the Gaussian blur and Laplacian filter \citep{gonzalez2018}.
@@ -819,31 +822,54 @@ While the main drawbacks of the LoG blob algorithms are: (i) being computational
 The total gradient anomaly (TGA) might be considered the ideal image to be used as input for the LoG blob detection algorithm for potential field studies (micro and/or macroscale).
 The TGA highlights the subsurface sources by generating a map of positive magnetic anomalies concentrated within their edges.
 This technique is widely used in aeromagnetic surveys to determine the boundaries of sources by calculating the magnetic gradient in all Cartesian directions and displaying those regions where the gradient has maximum values, which is a local maxima distribution.
-Hence. The application for micromagnetic measurements comes with all the advantages and drawbacks previously mentioned because is highly dependent on the selection of a good data window.
+Hence, the application for micromagnetic measurements comes with all the advantages and drawbacks previously mentioned because is highly dependent on the selection of a good data window.
 Nonetheless, the windows generated isolate the main magnetic signal’s region of each source.
 This guarantees that our thresholding approach (see section~\ref{dipole-reliability}), for both ED and dipolar inversion, is performed using the critical slice of the micromagnetic data, giving satisfactory parameters approximation and fast results as shown in the synthetic data.
 
-The complex synthetic data allows better observation of the strengths and limitations of the windows approach.
-The main strengths that can be mentioned are: (i) the applied technique not only detects most of the modeled sources but also (ii) most of the recovered magnetic parameters have considerably low errors, especially in the directions, usually less than 5° (Figure~\ref{complex-synthetic-comparison}a).
-(iii) The magnetic moments obtained from well-individualized sources tend to not deviate much from the real values (Figure~\ref{complex-synthetic-comparison}b) when $R^2$ and SNR scores are considered high ($\geq 0.85$ and $\geq 5$, respectively) (Figure~\ref{complex-synthetic-comparison}c-d).
-(iv) Shallow particles grouped in clusters are usually well individualized during window selection, as well as (v) some isolated particles that produce a weak magnetic signal.
-The major limitations observed were: (i) the blob detection fails when there are sources too close, grouping them into the same window, thus causing an erroneous result both for Euler deconvolution and for the magnetic parameters.
-(ii) The very same occurs when there is a source under another, in this case, the magnetic signal is the sum of both.
-(iii) In clusters of larger and/or deeper particles, although the method individualizes them well, the magnetic signal of the neighboring particles can considerably influence the result of the inversion, especially the estimated dipole moment (cluster in the Figure~\ref{complex-synthetic-comparison}b with the highest misfit values).
-As expected, there is a direct relationship between the dipole intensity and depth with the observed errors.
-It is clear from the error bars in Figure~\ref{complex-synthetic-comparison} that deep-seated sources and/or particles with small dipole moments generate worse results, essentially because they will produce weaker anomalous fields in the magnetic maps.
-Note nonetheless, that even sources with small dipole moments when close to the surface are adequately modeled by our method, because of the trade-off between signal and noise for grains near the sensor.
+While the windows approach violates the fundamental theory of the inversion problem that  requires the sampled area to be finite and encapsulated by the inversion domain to ensure the uniqueness of results \citep{Baratchart2013,Lima2013}, our technique is similar to the  one reported by \cite{Weiss2007}.
+The last-mentioned involves thresholding the long-distance interaction
+of each dipole in the SMM data, which excludes the effect of other dipoles by setting their contribution to zero, resulting in a sparse matrix that permits faster calculations.
+In contrast to this approach, we employ the TGA map to select the windows and isolate the area containing the main signal of the desired dipole, while the area out of the boundaries of the window is less sensitive to variation in magnetic parameters of this particular source, hence we exclude them from the inversion domain.
+This technique allows us to obtain the 3D position and an approximation of the dipole moment components of hundreds of sources within a few seconds, while the inversion is fast the time bottleneck of our methodology is associated with the blob detection process.
+
+Another main limitation arises from the spatial constraints inherent to our approach. Specifically, the blob detection struggles when dealing with sources that are closely spaced or overlapping, in the last case, it is unable to discern the magnetic sources. Through multiple tests (Figure~\ref{detection-map}), we have found that, for shallow sources, with sensor-sample height $\leq 5 \mu m$, a minimum separation distance of approximately 14 $\mu m$ is necessary to achieve successful source detection. This distance steadily increases for deeper seated sources, requiring around 20 $\mu m$ of separation for sensor-sample height of 25 $\mu m$. This immensely impacts the algorithm's detection capacity, as the particle count escalates, there is a persistent decline in the rate of successful source detection, as shown in Figure~\ref{grain-concentration}a. In essence, the algorithm's effectiveness diminishes as sources become more densely packed, posing a challenge in scenarios where particle density is high (e.g., extrusive rocks). On the other hand, as shown in our complex synthetic and real rock samples the technique could be densely applied to rocks with a lower concentration of magnetic grains (e.g., carbonates), due to its high successful rate for detection of sources.
 
 
-\subsection{Reliability of dipole moment approximation}
+\begin{figure}[tb!]
+\centering
+\includegraphics[width=0.5\linewidth]{paper/figures/detection-map.png}
+\caption{
+Simulation to assess the algorithm's ability to discern between two sources, with different horizontal separation and varying sensor-sample heights. The black line represents the boundary where the algorithm's is capable of identify two sources.
+}
+\label{detection-map}
+\end{figure}
+
+
+\subsection{Critical assessment of source position determination} %Prior information and uniqueness of solutions
+
+Working with potential field data might be very tricky once there is too much ambiguity involved during data modeling, thus to obtain unique and reliable results from data inversion it is necessary to provide as much prior information as possible.
+One way to circumvent the ambiguity is to incorporate prior information about the subsurface structure, such as the position of a known source of magnetization.
+Magnetic field measurements are more sensitive to changes in magnetization near the source that is causing the anomaly.
+When the position of the source is known, it constrains the model to be as consistent as possible with the observed data, hence increasing the likelihood of obtaining unique solutions.
+\citet{Oliveira2015Estimation} proved that the magnetization directions (Dec and Inc) recovered by the least squares estimator are sensitive to great variations in the horizontal coordinates of the center of the magnetic sources, but are practically insensitive to variations in depth.
+Thus, they consider the ED method as an adequate technique to estimate the central positions that will be used as prior information for inversion.
+This occurs mainly because, when well performed, the recovery of the source's horizontal coordinates is considerably accurate, while the vertical coordinate can undergo greater variation even though it still provides satisfactory results \citep{Silva20033D, Melo2013}.
+
+This remark is also better observed in our simple synthetic sample where the estimated horizontal positions slightly deviate from the true values, which implies small misfit values in the recovered magnetic directions.
+Although the estimated magnetic moment for the said sample is satisfactory, this magnetic parameter is more affected by the variations in the depth of the source, which is probably caused by ambiguities. Despite the fact that we use the ED original formulation dedicated to dipolar sources ($\eta = 3$), the technique did not present significant difficulties in estimating the 3D position of non-dipolar sources. This adaptability allows for an extension of its application to magnetic particles with a strong influence of higher-order magnetic anomalies. Lastly, as shown in the complex synthetic sample, the ED can reliably estimated the position of well-individualized sources, however when dealing with clustered particles the Euler's solutions start to deviate from the true positions. This deviation is particularly notable in the z-coordinate, which is showed by \cite{Oliveira2015Estimation} to not affect the magnetization direction estimation. However, the scenarios with closely spaced magnetic sources, where the inherent assumptions of Euler's method encounter challenges in accurately capturing the complex interactions of magnetic field anomaly caused by each nearby source, greatly interfering in the dipole intensity estimation. 
+
+In summary, in order to estimate the Cartesian position as precisely as possible the ED must be executed within a data window containing only one magnetic source and the lowest amount possible of noise, since the high-frequency noise sensibility is also one of the ED's limitations. As these assumptions deviate from the ideal case, the ED estimates also become less accurate. 
+
+\subsection{Critical assessment of dipole moment approximation} %Reliability of dipole moment approximation
 \label{dipole-reliability}
 
 Our approach relies in the premise of assuming the magnetic anomaly within
 the data window is a response of a dipolar source.
 The latter is true when working
-with particle signals in the SD magnetic domain state since they are uniform magnetized particles with strong dipolar anomalies.
+with particle signals in the SD magnetic domain state since they are uniform magnetized particles \citep{Dunlop1997} with strong dipolar anomalies.
 However, \cite{Nagy2017} reported that particles within the PSD domain can record the paleomagnetic field for longer (than SD ones) periods of time, being the stabler and also with strongly non-dipolar characteristics.
-Therefore the application of the proposed algorithm to natural samples should fail for those PSD particles.
+Hence, the implementation of the proposed algorithm in natural samples is expected to be unsuccessful in domains other than the SD state. In these instances, where sources may exhibit higher-order magnetic anomalies influence, such as quadrupole or octupole \citep[e.g.,][]{CortesOrtuno2021}, the dipole model fitting process may not yield satisfactory results. Consequently, the presence of higher-order anomalies within the magnetic sources can impact the accuracy of our inversion results. 
+
 \cite{CortesOrtuno2022} give important insights about the matter, they showed that PSD state particles present more accurate inversion results when considering the non-dipole components for small sample-sensor distances (\textless 1 $\mu$m), but for larger sensor distances the dipole as approximations are remarkably accurate, as the higher-order moments decay rapidly with distance and therefore have less
 influence on the particle's magnetic signal.
 Thus, our approach can be considered reasonable to work with both particle SD and PSD states signals.
@@ -853,15 +879,8 @@ Despite the excellent signal-to-noise ratio that the SMM provided with the
 proximity of the sensor to the sample, it is worth mentioning that the
 measurement noise can still overshadow the responses of very weak/small, or
 deep particles, generating unreliable inversion results.
-Therefore, it is necessary to keep a check to determine if the inversion reached a satisfactory prediction, such as the coefficient of determination and the
-signal-to-noise ratio suggested by \citep{CortesOrtuno2021}.
-
-While the windows approach violates the fundamental theory of the inversion problem that  requires the sampled area to be finite and encapsulated by the inversion domain to ensure the uniqueness of results \citep{Baratchart2013,Lima2013}, our technique is similar to the  one reported by \cite{Weiss2007}.
-The last-mentioned involves thresholding the long-distance interaction
-of each dipole in the SMM data, which excludes the effect of other dipoles by setting their contribution to zero, resulting in a sparse matrix that permits faster calculations.
-In contrast to this approach, we employ the TGA map to select the windows and isolate the area containing the main signal of the desired dipole, while the area out of the boundaries of the window is less sensitive to variation in magnetic parameters of this particular source, hence we exclude them from the inversion domain.
-This technique allows us to obtain the 3D positioning and an approximation of the dipole moment components of hundreds of sources within a few seconds, while the inversion is fast the time bottleneck of our methodology is associated with the blob detection process.
-
+Therefore, it is necessary to keep a check to determine if the inversion reached a satisfactory prediction, such as the coefficient of determination \citep[dipolarity test, ][]{Fu2020} and the
+signal-to-noise ratio suggested by \cite{CortesOrtuno2021}. This filtering process is better observed in the complex synthetic data where it becomes evident the direct relationship between the poorly estimated dipole moment and direction with the lowest values for both $R^2$ and SNR scores (Figure~\ref{complex-synthetic-comparison}).
 
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 \section{Conclusion}
@@ -870,9 +889,9 @@ We developed an efficient semi-automated method to determine the direction of ma
 Being ideal for a reinterpretation for the application of methods of paleomagnetic studies using thin sections of rock samples.
 This would be an attempt to improve the quality of results obtained by isolating the responses of more reliable recorders of the Earth's geomagnetic field.
 
-We also present a new, faster, and cleaner way to solve the Euler equation in determining the positioning of magnetic anomaly sources using a pre-selection of magnetic anomaly source windows based on the Laplacian of Gaussian applied to total gradient anomaly maps.
+We also present a new, faster, and cleaner way to solve the Euler equation in determining the position of magnetic anomaly sources using a pre-selection of magnetic anomaly source windows based on the Laplacian of Gaussian applied to total gradient anomaly maps.
 In this way, reducing the numerous solutions to just one data window per source.
-After estimating the structural index ($n = 3$) by approximating the sources generating the magnetic anomaly to spheres/points, the Euler Deconvolution is performed, and the central position of each source is determined.
+After estimating the structural index ($\eta = 3$) by approximating the sources generating the magnetic anomaly to spheres/points, the Euler Deconvolution is performed, and the central position of each source is determined.
 Due to the similarity with aeromagnetic data, this approach can also be extrapolated for macro-scale studies.
 
 To recover magnetic direction and moment we only need to assume that the sources have their central positions known (so we apply Euler deconvolution) and that their magnetization is uniform.
