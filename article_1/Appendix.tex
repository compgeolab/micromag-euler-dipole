\section{Appendix A}
\subsection{Appendix A.1}
\label{AppendixA1}

\noindent{As the least squares estimate (\cref{eq:sphere11}) is very sensitive to the presence of outliers in the observed data, the estimated parameters could be seriously misleading. To counteract this problem \cite{OliveiraJr.2015} suggest a robust scheme based on the minimization of the objective function obtained with the absolute error:}

\begin{equation} \label{eq:sphere12}
\centering
\small f\left(\widetilde{m}\right)=\left(\sum_{i=1}^{N}\left| { \left(\bar{\bar{A}} \cdot \bar{m} \right)}_{i} - {{\bar{\left(B_z\right)}}}_{i} \right|\right)
\end{equation}

\noindent{Unlike the solution presented for the objective function in \cref{eq:sphere11}, the parameter vector minimizing \cref{eq:sphere12} cannot be obtained as a simple linear system. A practical way is the iteratively reweighted least squares algorithm \citep{Aster2019, OliveiraJr.2015}. In this algorithm, at each iteration k, the following linear system is solved:}

\begin{equation} \label{eq:sphere13}
\centering
\small {\widetilde{m}}^{k+1}=\left({\bar{\bar{A}}}^T\cdot{\bar{\bar{R}}}^k\cdot\bar{\bar{A}}\right)^{-1}\cdot\left({\bar{\bar{A}}}^T\cdot{\bar{\bar{R}}}^k\cdot{\bar{B}}_z\right)\ \ 
\end{equation}

\noindent{The term ${\bar{\bar{R}}}^k$ is an N $\times$ N diagonal matrix whose i-th element $r_i^k$ (i = 1, 2, ..., N) is given by:}

\begin{equation} \label{eq:sphere14}
{r_i}^k=\frac{1}{\left|\left(\bar{\bar{A}}\cdot\bar{m}\right)_i-{{\bar{B_z}}}_i+e\right|}
\end{equation}

\begin{FlushRight}
\noindent{Where: $e$ is a small positive number used to prevent singularities}
\end{FlushRight}

\noindent{This iterative process starts (k = 0) with the solution vector obtained by the least squares estimator (\cref{eq:sphere11}). From this initial approximation ${\widetilde{m}}^0$, we calculate the matrix ${\bar{\bar{R}}}^0$ (\cref{eq:sphere14}). Which is used in the solution of the linear system given by \cref{eq:sphere13} to obtain the estimate ${\widetilde{m}}^1$. Later using this updated estimate to calculate the new matrix ${\bar{\bar{R}}}^1$ (\cref{eq:sphere14}), we solve the linear system (\cref{eq:sphere13}) to obtain a new estimate ${\widetilde{m}}^ 2$, and so on. As the iterations progress, this iterative procedure tends to converge and estimate $\widetilde{m}$, which is called robust estimate \citep{OliveiraJr.2015}. According to \cite{Aster2019} this convergence can be limited by a tolerance $\tau$, given by:}

\begin{equation} \label{eq:sphere15}
\centering
\frac{\lVert {\widetilde{m}}^{k+1} - {\widetilde{m}}^{k} \lVert}{1 + \lVert \widetilde{m}^{k+1} \lVert} â‰¤ \tau
\end{equation}

\begin{FlushRight}
\noindent{Where: $\tau$ is a positive number (\emph{e.g.}, ${10}^{-2}$) chosen by the algorithm user.}
\end{FlushRight}

\noindent{The convariance matrix for the uncertainties propagation also is updated with the ${\bar{\bar{R}}}^k$, as shown in the \cref{eq:sphere19}:}

\begin{equation} \label{eq:sphere19}
\centering
\small \bar{\bar{Cov}}\left(\widetilde{m_j}\right)=\ {\sigma_0}^2\cdot\left({\bar{\bar{A}}}^T\cdot ~ {\bar{\bar{R}}}^k\cdot ~ \bar{\bar{A}}\right)^{-1} \ \ \text{(\emph{robust})}
\end{equation}


\subsection{Appendix A.2} 
\label{AppendixA2}

\noindent{The derivatives of the propagation functions of the uncertainties of the declination ($\sigma_{D_j}$), inclination ($\sigma_{I_j}$) and magnetic moment ($\sigma_{m_j}$) in relation to each parameter ($mx_j, my_j, mz_j$) are detailed below:}

\begin{equation} \label{eq:sphere23}
\centering
\frac{\partial D_j}{\partial{mx}_j}=\frac{-{my}_j}{{{mx}_j}^2+{{my}_j}^2}
\end{equation}

\begin{equation} \label{eq:sphere24}
\centering
\frac{\partial D_j}{\partial{my}_j}=\frac{{mx}_j}{{{mx}_j}^2+{{my}_j}^2}
\end{equation}

\begin{equation} \label{eq:sphere25}
\centering
\frac{\partial I_j}{\partial{mx}_j}=\frac{-{mx}_j\cdot \ {mz}_j}{\sqrt{{{mx}_j}^2+{{my}_j}^2}\cdot \left({{mx}_j}^2+{{my}_j}^2+{{mz}_j}^2\right)}
\end{equation}

\begin{equation} \label{eq:sphere26}
\centering
\frac{\partial I_j}{\partial{my}_j}=\frac{-{my}_j\cdot \ {mz}_j}{\sqrt{{{mx}_j}^2+{{my}_j}^2}\cdot \left({{mx}_j}^2+{{my}_j}^2+{{mz}_j}^2\right)}
\end{equation}

\begin{equation} \label{eq:sphere27}
\centering
\frac{\partial I_j}{\partial{mz}_j}=\frac{\sqrt{{{mx}_j}^2+{{my}_j}^2}}{\left({{mx}_j}^2+{{my}_j}^2+{{mz}_j}^2\right)}
\end{equation}

\begin{equation} \label{eq:sphere28}
\centering
\frac{\partial m_j}{\partial{mx}_j}=\frac{{mx}_j}{ \sqrt{{{mx}_j}^2+{{my}_j}^2+{{mz}_j}^2} }
\end{equation}

\begin{equation} \label{eq:sphere29}
\centering
\frac{\partial m_j}{\partial{my}_j}=\frac{{my}_j}{ \sqrt{{{mx}_j}^2+{{my}_j}^2+{{mz}_j}^2} }
\end{equation}

\begin{equation} \label{eq:sphere30}
\centering
\frac{\partial m_j}{\partial{mz}_j}=\frac{{mz}_j}{ \sqrt{{{mx}_j}^2+{{my}_j}^2+{{mz}_j}^2} }
\end{equation}